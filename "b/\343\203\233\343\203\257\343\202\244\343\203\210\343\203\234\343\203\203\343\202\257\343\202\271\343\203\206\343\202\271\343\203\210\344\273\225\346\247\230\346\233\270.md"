# ホワイトボックステスト仕様書

## 1. テスト対象
本仕様書は、リポジトリ「OpenHands-Test2」のPythonバッチ処理（script.py, modules配下）に対するホワイトボックステストの仕様を記載する。

## 2. テスト方針
- 各関数・モジュール単位でのユニットテストを中心とする。
- 主要な分岐、例外処理、異常系入力、正常系入力を網羅する。
- テストはpytestを用い/tests配下に配置する。

## 3. テスト観点・仕様

### 3.1 S3ダウンロード関連（modules/s3_download.py）
- list_csv_files: 指定日付・拡張子・パス形式のフィルタが正しく動作するか
- download_csv: S3からのダウンロード呼び出し、ローカル保存パスの生成

### 3.2 データ検証処理（modules/check_process.py）
- load_column_types: columns.txtのパース、異常系（不正フォーマット行）
- check_values:
    - 各型（datetime, float, int, str）ごとの正常・異常値処理
    - 欠損値・空文字・Noneの補完
    - 不要カラムの削除
    - ワーニング出力内容

### 3.3 S3アップロード・ZIP圧縮（modules/s3_upload.py）
- zip_csv_files: 複数CSVのZIP化、ファイル存在チェック
- upload_csv: S3アップロード呼び出し

### 3.4 メインバッチ（script.py）
- S3一覧取得～ダウンロード～検証～ZIP化～アップロードの一連の流れ
- 異常系（S3取得失敗、検証エラー、ファイルなし等）
- 並列処理の分岐網羅

## 4. テストデータ
- data/test, data/test1配下のCSVを利用
- columns.txtの型定義を利用

## 5. テスト実施方法
- pytestで/tests配下のテストを実行
- Docker環境でもpytest実行可能

## 6. 期待結果
- すべてのテストケースがパスすること
- 主要な分岐・例外が網羅されていること

---
2025年6月26日 作成
